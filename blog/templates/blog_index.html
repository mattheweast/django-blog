{% extends 'base.html' %}
{% load markdown_extras %}
{% block page_content %}  
<div class="post-list-header">
    <h1>Feed</h1>
    {% if categories %}
        <div class="categories">
            {% for category in categories %}  
                <a href="{% url 'blog_category' category=category.name %}" class="category-badge">{{ category.name }}</a>  
            {% endfor %}
        </div>
    {% endif %}
</div>

{% for post in posts %}
    <article class="post-card">
        <h2><a href="{% url 'blog_detail' pk=post.pk %}">{{ post.title }}</a></h2>
        <div class="post-meta">
            Posted on {{ post.created_on|date:"F d, Y" }}
            {% if post.categories.all %}
                in
                {% for category in post.categories.all %}
                    <a href="{% url 'blog_category' category=category.name %}">{{ category.name }}</a>{% if not forloop.last %}, {% endif %}
                {% endfor %}
            {% endif %}
            {% if user.is_authenticated %}
                | <a href="{% url 'post_edit' pk=post.pk %}" class="nav-link">edit</a>
            {% endif %}
        </div>
        <p class="post-excerpt">{{ post.body|markdown|truncatewords_html:40|safe }}</p>
    </article>
{% empty %}  
    <div class="empty-state">
        <p>No posts yet. <a href="/admin/blog/post/">Create your first post</a> in the admin panel.</p>
    </div>
{% endfor %}  
{% endblock %}  